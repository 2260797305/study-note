# 计算机组成原理

# 1、存储器

## 1.1、分类：

### 1.1.1、存储介质：

- 半导体存储器：U盘，内存条等等；
- 磁存储器： 磁带，磁盘
- 光存储器：光盘；

### 1.1.2、存储功能：

- 主存储器： 又称内存，用来存放计算机运⾏期间所需要的程序和数据，  容量小、 存取速度快、 断电后数据丢失； SDRAM，DDR 等等
- 辅助存储器： 又称外存，容量大、 存取速度慢、 断电后数据不丢失，如硬盘，cd ，flash等等；
- 高速缓冲存储器：简称Cache，存放主存中经常使⽤的内容的备份，容量小，速度快，价格昂贵；
- 控制存储器：存放实现全部指令系统的所有微程序，

### 1.1.3、访问方式

- **随机访问存储器（Random Access Memory， RAM）**：RAM中的每⼀个单元都可以独立地直接访问 ，在计算机系统中， RAM主要用作主存和⾼速缓冲存储器 ；大多半导体存储器属于这种；
- **顺序访问存储器（Sequential Access Memory， SAM）**：SAM中的单元一般不能被独立访问，速度慢，价格低；

## 1.2、存储单元与芯片：

### 1.2.1、静态随机存储器 ：

**静态随机存储器（Static Random Access Memory， SRAM）**  ，该种存储器只要保持有源状态， 其中所储存的数据就可以一直保持而不丢失 ；

### 1.2.2、动态随机存储器：

- **动态随机存取存储器（Dynamic Random Access Memory， DRAM）** ，数据即使在有源状态下也只能保持较短的时间， 需要不断地进行刷新来维持数据的存储状态 ；
- **同步动态随机存取存储器（Synchronous DRAM， SDRAM）**：是有一个同步接口的动态随机存取内存DRAM）；DRAM是有一个异步接口的，没有同步接口；
- **双倍速率同步动态随机存储器（Double Data Rate， DDR）：**为具有双倍数据传输率的SDRAM，其数据传输速度为系统时钟频率的两倍，由于速度增加，其传输性能优于传统的SDRAM。

### 1.2.3、只读存储器：

**只读存储器（Read Only Memory, ROM）**,作为主存的⼀部分，用于存放一些固定的程序，如监控程序、 启动程序、 磁盘引导程序等 ，原则上一旦写入便不能修改；但是有部分特殊的ROM；

- **掩膜式只读存储器（Mask Read-Only Memory， MROM）**：内容是由半导体制造厂按用户提出的要求在芯片的生产过程中直接写入的，写入之后任何人都无法改变其内容。
- **可编程只读存储器（Programmable read-only memory，PROM）**：
- **可擦除可编程只读存储器（Erasable Programmable Read Only Memory，EPROM）** ：EPROM是一种可擦除可编程只读存储器。 它可以由用户对其所存信息做任意次的改写 ；

### 1.2.4、flash

又称闪存，它结合了ROM和RAM的长处，可擦可写，断电不会丢失数据；U盘 和mp3 中就是使用的这种存储器；

flash 中每一位只能由 ‘’1‘ --> ’0‘，所以在写之前，必须对flash 进行 “擦除”（即把每一位强行置为1）

- **nand flash**: 不能运行代码，容量较大；读取速度慢，写入速度快，擦除速度快；可擦除次数： 100万次； 区块性的方式进行读取 
- **nor flash**: 可以直接运行装载在 nor flash 中的代码；容量较小，价格较贵；读取速度较快；写入速度较慢，擦除速度较慢；可擦除次数： 10万次； 允许随机存取存储器上的任何区域；
- 理论上 SPI flash 可以是nand flash，也可以是NOR flash，但是通常情况下都是 NOR flash；





# 2、8086 指令系统

## 2.1、寻址方式

计算机的指令通常包含操作码和操作数两部分， 操作码指出操作的性质， 操作数给出操作的对象。  指令执⾏时寻找操作数地址的过程称为寻址； 寻找操作数存放地址的各种⽅式称为寻址⽅式。 

### 2.1.1、立即寻址方式 

在立即寻址（Immediate Addressing） 方式下， 操作数直接包含在指令中， 它是一个8位或16位的常数， 也叫立即数。 如果立即数是16位数， 则高字节存放在代码段的高地址单元中， 低字节存放在低地址单元中。立即寻址方式的指令常用来给寄存器赋初值 ；

```
MOV AL， 56H
MOV CX， 9A68H
```

![1563504423282](C:/Users/yuki/Desktop/pc/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86.assets/1563504423282.png)

### 2.1.2、寄存器寻址

操作数包含在寄存器中， 由指令指定寄存器的名称。 对于16位操作数， 寄存器可以是 AX， BX， CX， DX， SI， DI， SP 和 BP 等； 对于8位操作数， 则用寄存器 AH， AL， BH， BL， CH， CL， DH 和 DL。 

```
MOV CX， AX
```

### 2.1.3、直接寻址方式 

```
MOV AX， ［2000H］
```

这条指令直接给出了操作数的有效地址EA＝2000H。 设DS＝ 3000H， 则源操作数的物理地址＝16×3000H＋2000H＝32000H。 若地址32000H中的内容为34H， 32001H中的内容为12H， 用（32000H） ＝
1234H来表示这个字。 则执行指令后， AX＝1234H。 指令执⾏过程如图所示 

![1563511096987](C:/Users/yuki/Desktop/pc/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86.assets/1563511096987.png)

```
MOV AX， VAL
MOV AX， ES： ［500H］ #该指令的源操作数的物理地址等于16×ES＋500H
```

### 2.1.4、寄存器间接寻址方式 

若指令中给出的寄存器中的值不是操作数本身，而是操作数的有效地址， 这种寻址方式称为寄存器间接寻址；

此时寄存器名称外⾯必须加方括号， 以与寄存器寻址方式向区别；

能够用来间接寻址的寄存器只能是寄存器 SI， DI， BP， BX 其中之一；其中 BX，BP 成为基地址寄存器，SI， DI 称为变址寄存器；

寄存器的内容为操作数的偏移地址EA， 而操作数存放在存储器中；

若指令中指定的寄存器是BX， DI或SI， 则操作数在当前数据段中， 所以操作数的物理地址EA的形成是由数据段寄存器DS  的内容左移4位， 加上BX， DI或SI中的偏移地址EA。 若指令中指定的寄存器是BP， 则操作数在当前堆栈段中， 所以操作数的物理地址EA的形成是  堆栈段寄存器SS的内容左移**4**位， 加上BP中的偏移地址EA形成操作数的物理地址EA

```
MOV AX， ［BX］
```

执行前： AX＝56H， BX＝100H， DS＝1000H， （10100H） ＝60FEH 

执行后： AX＝60FEH， BX， DS， （10100H） 的内容未变 

### 2.1.5、寄存器相对寻址方式

操作数的有效地址是一个基址或变址寄存器的内容与指令中指定的8位或16位位移量（Displacement） 之和， 

寄存器相对寻址方式与寄存器间接寻址十分相似， 主要区别是前者在有效地址上还要加一个位移量。 同样， 当指令中指定的寄存器是BX、 SI或DI时， 段寄存器使用DS，当指定寄存器是BP时， 段寄存器使用SS 

```
MOV AX， NAME［BX］
```

设DS＝2000H， SI＝2000H， 位移量NAME＝100H， （BX） ＝1000H，

则物理地址＝16×DS＋（BX＋NAME） ＝20000H＋1000H＋100H＝21100H 



### 2.1.6、基址变址寻址方式

基址变址寻址（Based Indexed Addressing）方式的操作数的有效地址是一个基址寄存器（BX或BP） 和一个变址寄存器（SI或DI） 的内容之和， 两个寄存器均由指令指定。 

若基址寄存器为BX时， 段址寄存器⽤DS， 则
物理地址＝16×DS＋BX＋SI＝16×DS＋BX＋DI 

若基址寄存器为BP时， 段址寄存器应⽤SS， 则
物理地址＝16×SS BP＋SI＝16 x SS + BP+DI 

```
MOV AX， ［BX］ ［SI］ #等同于 MOV AX， ［BX＋SI］ 
```

设DS＝3000H， BX＝1200H， SI＝0500H， （31700H） ＝0ABCDH， 则
物理地址＝16×DS＋BX＋SI＝30000H＋1200H＋0500H＝31700H
该指令的执行结果： AX＝0ABCDH。 



### 2.1.7、基址变址相对寻址方式 

操作数的有效地址是一个基址寄存器和一个变址寄存器的内容， 再加上指令中指定的8位或16位位移量之和。 

若基址寄存器为BX时，用DS作段寄存器， 则 

​		物理地址＝16×DS＋BX＋SI＋8位 

或：

​		16位位移量＝16×DS＋BX＋DI＋8位或16位位移量 

若基址寄存器为BP时， 应用SS作段寄存器， 则
		物理地址＝16×SS＋BP＋SI＋8位或16位位移量
或
		＝16×SS＋BP＋DI＋8位或16位位移量。 

## 2.2、指令 

- 数据传送指令
- 算术运算指令
- 逻辑运算指令
- 移位指令
- 转移指令
- 字符串操作指令
- 处理器控制指令
- 输入/输出指令
- 中断指令 

### 2.2.1、数据传送指令 

数据传送指令用来实现寄存器和存储器间的字节或字的数据传送。 其中包括堆栈操作、 地址传送等指令。 

数据传送指令MOV 

交换指令XCHG 

传送偏移地址指令LEA 

传送32位地址指针指令LES 

进栈指令PUSH 

POP DST 

### 2.2.2、加减运算指令 

常规加法指令ADD 

带进位加指令ADC 

加1指令INC 

常规减法指令SUB 

带借位减指令SBB 

减1指令DEC 

取补指令NEG 

比较指令CMP 

### 2.2.3、乘除运算指令 

无符号数乘法指令MUL 

有符号数乘法指令IMUL 

无符号数除法指令DIV 

有符号数除法指令IDIV 

字节转换为字指令CBW 

字转换为双字指令CWD

### 2.2.4、逻辑运算和移位指令 

非操作指令NOT 

与操作指令AND 

或操作指令OR 

异或操作指令XOR 

测试指令TEST 

算术左移或逻辑左移指令SAL/SHL 

​	右边补0

算术右移指令SAR  

​	如果最高有效位是0， 那么右移之后， 在左边添加的就是0； 如果最高有效位是
​	1， 那么右移之后， 在左边添加的就是1。

逻辑右移指令SHR 

​	左边补0

不带进位标志CF的左循环移位指令ROL 

不带进位标志CF的左循环移位指令ROR

带进位标志CF的左循环移位指令RCL 

带进位标志CF的左循环移位指令RCR

### 2.2.4、转移指令 

JMP ⽆条件转移

CALL 过程调用

RET 过程返回 

LOOP 循环指令

LOOPZ 相等循环指令

LOOPNZ 不相等循环指令 



# 3、寄存器（arm）

![1563517896252](C:/Users/yuki/Desktop/pc/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86.assets/1563517896252.png)

![1563517934127](C:/Users/yuki/Desktop/pc/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86.assets/1563517934127.png)



ARM处理器共有37个寄存器。其中包括：31个通用寄存器，包括程序计数器(PC)在内。这些寄存器都是32位寄存器。以及6个32位状态寄存器。但目前只使用了其中12位。ARM处理器共有7种不同的处理器模式，在每一种处理器模式中有一组相应的寄存器组。任意时刻(也就是任意的处理器模式下)，可见的寄存器包括15个通用寄存器(R0～R14)、一个或两个状态寄存器及程序计数器(PC)。在所有的寄存器中，有些是各模式共用的同一个物理寄存器；有一些寄存器是各模式自己拥有的独立的物理寄存器。



| 用户模式 | 系统模式 | 特权模式      | 中止模式      | 未定义指令模式 | 外部中断模式  | 快速中断模式  |
| -------- | -------- | ------------- | ------------- | -------------- | ------------- | ------------- |
| R0       | R0       | R0            | R0            | R0             | R0            | R0            |
| R1       | R1       | R1            | R1            | R1             | R1            | R1            |
| R2       | R2       | R2            | R2            | R2             | R2            | R2            |
| R3       | R3       | R3            | R3            | R3             | R3            | R3            |
| R4       | R4       | R4            | R4            | R4             | R4            | R4            |
| R5       | R5       | R5            | R5            | R5             | R5            | R5            |
| R6       | R6       | R6            | R6            | R6             | R6            | R6            |
| R8       | R8       | R8            | R8            | R8             | R8            | R8_fiq        |
| R9       | R9       | R9            | R9            | R9             | R9            | R9_fiq        |
| R10      | R10      | R10           | R10           | R10            | R10           | R10_fiq       |
| R11      | R11      | R11           | R11           | R11            | R11           | R11_fiq       |
| R12      | R12      | R12           | R12           | R12            | R12           | R12_fiq       |
| R13      | R13      | R13_svc       | R13_abt       | R13_und        | R13_inq       | R13_fiq       |
| R14      | R14      | R14_svc       | R14_abt       | R14_und        | R14_inq       | R14_fiq       |
| PC       | PC       | PC            | PC            | PC             | PC            | PC            |
| CPSR     | CPSR     | CPSR SPSR_svc | CPSR SPSR_abt | CPSR SPSR_und  | CPSR SPSR_inq | CPSR SPSR_fiq |



## 3.1、通用寄存器

​	通用寄存器可以分为下面3类：**未备份寄存器(The unbanked registers)**，包括R0～R7。**备份寄存器**(The banked registers)，包括R8～R14。**程序计数器**PC，即R15。

### 3.1.1、未备份寄存器

​	未备份寄存器包括R0～R7。对于每一个未备份寄存器来说，在所有的处理器模式下指的都是同一个物理寄存器。在异常中断造成处理器模式切换时，由于不同的处理器模式使用相同的物理寄存器，可能造成寄存器中数据被破坏。未备份寄存器没有被系统用于特别的用途，任何可采用通用寄存器的应用场合都可以使用未备份寄存器。

### 3.1.2、备份寄存器

​	对于备份寄存器R8～R12来说，每个寄存器对应两个不同的物理寄存器。例如，当使用快速中断模式下的寄存器时，寄存器R8和寄存器R9分别记作R8_fiq、R9_fiq；当使用用户模式下的寄存器时，寄存器R8和寄存器R9分别记作R8_usr、R9_usr等。在这两种情况下使用的是不同的物理寄存器。系统没有将这几个寄存器用于任何的特殊用途，但是当中断处理非常简单，仅仅使用R8～R14寄存器时，FIQ处理程序可以不必执行保存和恢复中断现场的指令，从而可以使中断处理过程非常迅速。**对于备份寄存器R13和R14来说，每个寄存器对应6个不同的物理寄存器**，其中的一个是用户模式和系统模式共用的；另外的5个对应于其他5种处理器模式。采用记号R13_<mode>来区分各个物理寄存器：

**寄存器R13在ARM中常用作栈指针， 即SP（stack pointer，栈顶指针）**

**寄存器R14又被称为连接寄存器**(Link Register，LR)，在ARM体系中具有下面两种特殊的作用：每一种处理器模式自己的物理R14中存放在当前子程序的返回地址。当通过BL或BLX指令调用子程序时，R14被设置成该子程序的返回地址。在子程序中，当把R14的值复制到程序计数器PC中时，子程序即返回。R14寄存器也可以作为通用寄存器使用。  

### 3.1.3、程序计数器R15

​	程序计数器R15又被记作PC, 由于ARM采用了流水线机制，当正确读取了PC的值时，该值为当前指令地址值加8个字节。也就是说，对于ARM指令集来说，PC指向当前指令的下两条指令的地址。

### 3.1.4、程序状态寄存器

​	CPSR(当前程序状态寄存器)可以在任何处理器模式下被访问。它包含了条件标志位、中断禁止位、当前处理器模式标志以及其他的一些控制和状态位。每一种处理器模式下都有一个专用的物理状态寄存器，称为SPSR(备份程序状态寄存器)。当特定的异常中断发生时，这个寄存器用于存放当前程序状态寄存器的内容。在异常中断程序退出时，可以用SPSR中保存的值来恢复CPSR。

由于用户模式和系统模式不是异常中断模式，所以它们没有SPSR。当在用户模式或系统模式中访问SPSR，将会产生不可预知的结果。

CPSR的格式如下所示。SPSR格式与CPSR格式相同。

| 31   | 30   | 29   | 28   | 27   | 26       | 7    | 6    | 5    | 4    | 3    | 2    | 1    | 0    |
| ---- | ---- | ---- | ---- | ---- | -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| N    | Z    | C    | V    | Q    | DNM(RAZ) | I    | F    | T    | M4   | M3   | M2   | M1   | M0   |

参考网址： https://www.cnblogs.com/schips/p/9053070.html

# 4、寄存器（x86）

![1563783529430](C:/soft_install/Typora)

# 5、专业术语

- APB(Advanced Peripheral Bus)，片上外设总线。主要用于慢速片上外设与ARM核的通讯。
- AHB(Advanced High performance Bus)，高性能总线。主要用于系统高性能、高时钟速率模块间通信。
-  FSMC(Flexible Static Memory Controller，可变静态存储控制器)是STM32系列采用的一种新型的存储器扩展技术。在外部存储器扩展方面具有独特的优势，可根据系统的应用需要，方便地进行不同类型大容量静态存储器的扩展。 